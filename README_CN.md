# Chinese Idioms Collection | 中国成语与歇后语英文译解

一个精美的中国成语与歇后语双语展示网站，包含经典成语和歇后语的英文翻译、详细解释和精美配图。

## ✨ 功能特点

- 📚 **经典成语** - 精选中国传统文化中最具代表性的成语，包含详细出处、含义和用法
- 🎭 **歇后语** - 收集经典歇后语，前半句谜面与后半句谜底的中英文对照
- 🖼️ **精美配图** - 每个成语和歇后语配有独特的艺术风格插图
- 🌐 **双语展示** - 中英文对照，便于国际友人理解中国文化
- 🎨 **现代设计** - 采用 shadcn/ui 组件库，响应式布局
- 🌙 **暗色模式** - 支持明暗主题切换
- 🔍 **搜索功能** - 快速查找成语和歇后语

## 🛠️ 技术栈

- **框架**: Next.js 16 (App Router)
- **语言**: TypeScript 5
- **UI组件**: shadcn/ui (Radix UI)
- **样式**: Tailwind CSS 4
- **主题**: next-themes
- **图标**: Lucide React

## 📦 本地开发

### 安装依赖

```bash
pnpm install
```

### 启动开发服务器

```bash
pnpm dev
```

访问 `http://localhost:3000` 查看网站

### 构建生产版本

```bash
pnpm build
```

构建完成后，静态文件将在 `out` 目录中。

### 预览生产构建

```bash
pnpm start
```

## 📁 项目结构

```
.
├── src/
│   ├── app/
│   │   ├── page.tsx          # 主页面（重定向到英文版本）
│   │   ├── en_US/            # 英文版本页面
│   │   ├── layout.tsx        # 全局布局
│   │   └── globals.css       # 全局样式
│   ├── components/
│   │   └── ui/               # shadcn/ui 组件库
│   ├── data/
│   │   ├── en_US/
│   │   │   ├── chengyu/      # 成语数据（JSON格式）
│   │   │   └── xiehouyu/     # 歇后语数据
│   │   ├── zh_CN/            # 中文数据目录
│   │   ├── language.ts       # 语言配置
│   │   └── simple.ts         # 简化数据
│   ├── hooks/                # 自定义 Hooks
│   ├── lib/                  # 工具函数
│   ├── shared/               # 共享模块
│   └── types/                # TypeScript 类型定义
├── public/
│   └── chengyu/              # 成语配图资源
├── scripts/
│   ├── IdiomsManager.ts      # 成语管理脚本
│   └── autoGen/              # 自动生成工具
├── next.config.js            # Next.js 配置
└── package.json              # 项目依赖
```

## 🎨 数据结构

### 成语数据格式

每个成语包含以下字段：

```typescript
{
  id: number,
  original: string,              // 成语原文（中文）
  translation: string,           // 英文翻译
  imageUrl: string,              // 图片路径
  source: string,                // 出处说明
  meaning: string,               // 含义解释
  usage: string,                 // 用法说明
  imgPositivePrompt: string,     // 图片生成正向提示词
  imgNegativePrompt: string,     // 图片生成负向提示词
  originalCountry: string        // 原产国
}
```

### 歇后语数据格式

每个歇后语包含前半句谜面和后半句谜底的中英文对照。

## 💡 实现思路

本项目旨在通过 AI 技术自动化生成中国成语与歇后语的英文译解内容，降低文化内容的创作门槛，让海外用户能够更轻松地了解中国传统文化。

### 设计理念

1. **内容自动化** - 利用大语言模型生成高质量的英文翻译、出处说明、含义解释和用法指导，无需人工撰写
2. **视觉艺术化** - 通过文生图技术为每个成语/歇后语生成独特的艺术插图，增强视觉吸引力
3. **双语友好** - 中英文对照展示，降低文化理解门槛
4. **结构化数据** - 统一的数据格式便于管理和扩展

### 整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                        用户输入层                            │
│              成语/歇后语名称（如：闻鸡起舞）                   │
└──────────────────────┬──────────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────────┐
│                      数据生成层                              │
│  ┌─────────────────────────────────────────────────────┐    │
│  │  DeepSeek LLM                                       │    │
│  │  • 生成结构化 JSON 数据                              │    │
│  │  • 英文翻译、出处、含义、用法                         │    │
│  │  • 图片生成的正负向提示词                             │    │
│  └─────────────────────────────────────────────────────┘    │
└──────────────────────┬──────────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────────┐
│                      图片生成层                              │
│  ┌─────────────────────────────────────────────────────┐    │
│  │  豆包/千问文生图 API                                  │   │
│  │  • 根据提示词生成艺术插图                             │    │
│  │  • Sharp 压缩为 WebP 格式                            │    │
│  └─────────────────────────────────────────────────────┘    │
└──────────────────────┬──────────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────────┐
│                      数据存储层                              │
│  • data.json - 完整数据（含所有字段）                         │
│  • simple.json - 简化数据（用于快速展示）                     │
│  • 图片文件 - WebP 格式存储在 public/ 目录                    │
└──────────────────────┬──────────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────────┐
│                      前端展示层                              │
│  • Next.js 16 静态导出                                       │
│  • shadcn/ui 组件库                                          │
│  • 响应式设计 + 暗色模式                                      │
└─────────────────────────────────────────────────────────────┘
```

### 核心模块

#### 1. 提示词工程（Prompt Engineering）

精心设计的提示词模板，确保生成内容的质量和一致性：

- **结构化输出** - 强制 LLM 返回 JSON 格式，便于程序解析
- **文化适配** - 英文翻译考虑文化差异，避免直译生硬
- **图片指导** - 生成详细的正负向提示词，控制图片风格和质量
- **风格多样性** - 支持多种艺术风格（水墨画、现代极简、动漫等）

#### 2. 数据管理

- **统一类型** - TypeScript 类型定义确保数据结构一致性
- **双份数据** - 完整版和简化版满足不同场景需求
- **增量更新** - 支持批量添加和删除单个条目

#### 3. 错误处理

- **JSON 解析容错** - 自动清理 markdown 标记
- **字段验证** - 确保必填字段完整
- **失败跳过** - 单个生成失败不影响整体流程
- **限流控制** - 避免请求过快触发 API 限制

### 扩展性设计

- **类型抽象** - `IdiomType` 支持成语、歇后语、谚语等多种类型
- **API 可插拔** - 支持多个图像生成服务（豆包、千问）
- **多语言支持** - 数据结构支持未来添加其他语言版本

## 🔧 添加新的内容

本项目支持通过 AI 自动生成成语和歇后语的内容与配图，无需手动准备资料。

### 自动生成流程

使用 `scripts/IdiomsManager.ts` 脚本，通过以下步骤自动生成内容：

1. **数据生成** - 调用 DeepSeek 大语言模型，根据输入的成语或歇后语生成结构化数据
   - 成语：原文、英文翻译、出处说明、含义解释、用法说明
   - 歇后语：前半句谜面、后半句谜底、中英文对照翻译
   - 同时生成图片的正负向提示词（Prompt）

2. **图片生成** - 调用图像生成 API（豆包/千问），根据生成的提示词创建艺术插图
   - 使用 Sharp 库进行图片压缩（WebP 格式）
   - 自动保存到 `public/` 目录

3. **数据保存** - 将生成的数据保存到 JSON 文件
   - 完整数据：`src/data/en_US/{type}/data.json`
   - 简化数据：`src/data/en_US/{type}/simple.json`

### 使用示例

```typescript
// 生成成语
const chengyuManager = new IdiomsManager(IDIOM_TYPE.chengyu);
chengyuManager.run(["闻鸡起舞", "鹤立鸡群"], true);

// 生成歇后语
const xiehouyuManager = new IdiomsManager(IDIOM_TYPE.xiehouyu);
xiehouyuManager.run("大海捞针——没处寻");
```

### 环境变量配置

需要在项目根目录创建 `.env.local` 文件，配置以下 API 密钥：

```env
# DeepSeek API - 用于生成文本数据
DEEPSEEK_API_KEY=your_deepseek_api_key

# 豆包 API - 用于生成图片
DOUBAO_ACCESS_KEY_ID=your_doubao_api_key

# 千问 API - 可选的图片生成服务
ALI_ACCESS_KEY_ID=your_ali_api_key
```

### 手动添加（可选）

如果需要手动添加内容：

1. 准备图片资源，放入 `public/chengyu/` 目录
2. 编辑 `src/data/en_US/chengyu/data.json` 文件，添加数据
3. 确保 `imageUrl` 路径与实际图片路径一致

## 📄 License

MIT

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

Made with ❤️ using Next.js & shadcn/ui